# Flink/Kafka Data Stream Processing
An end-to-end data engineering project involving all stages of the data engineering pipeline.
* Kafka + Flink + Debezium for CDC stream data processing
* Dimensional modeling for data modeling
* Dagster for data pipeline orchestration
* MySQL & Postgres source databases

## Project Context
A book store is looking to analyze their book sales, inventory and shipping efficiency. They currently have two operational databases which manage their business processes. The Postgres database contains data on their store, and a MySQL database tracks their deliveries.

## Data Ingestion
Data is being ingested using Kafka, Flink and Debezium. Kafka is used for storage between streams. Debezium is used to move CDC events from the source databases to Kafka. Flink is used to process the CDC events into the data model.
Flink jobs are shown in `flink-extractor`. \
Flink jobs use the Table API for moving the debezium Kafka topics into landing Kafka topics. \
After landing dimensions & Facts are generated using the Java DataStream API. \
Dagster is used to orchestrate all the Flink jobs \
![Image](images/Dagster%20Tree.PNG)

## Source Database & DW Schemas
The database schemas are contained in `database-init-scripts`
Data is generated by `mock-db-client`

### Debezium
Now everything is set up for Debezium. However, Debezium needs to know where the databases are and how to read them. It can know this by setting up connectors. This is done in the `utils/create_connector.py` script. Essentially it just posts configs to the Debezium instance.

### Kafka
With those Debezium settings, it will be able to send data to Kafka once changes are made to the databases. \
Once the first data events are sent to Kafka, it will create topics for each table. 


## Data Model
| Business Processes  | Grain                                 | Metrics       | Books | Carrier Services | Customers | Orders |
|---------------------|----------------------------------------|---------------|-------|------------------|-----------|--------|
| Item Transactions   | 1 row per book in an order            | Sales         |   X   |                  |     X     |   X    |
| Shipment Events     | 1 row per shipment of an order        | Delivery time |       |        X         |           |   X    |


